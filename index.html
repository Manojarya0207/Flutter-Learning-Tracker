<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Flutter Learning Tracker</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet" />
  <style>
    :root{
      --bg:#0d1117;--panel:#161b22;--panel-2:#1e2633;--text:#e6edf3;--muted:#8b949e;--brand:#00b4d8;--brand-2:#0096c7;--ok:#22c55e;--bad:#ef4444;--border:#30363d;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{font-family:'Poppins',sans-serif;background:var(--bg);color:var(--text);margin:0}
    header{position:sticky;top:0;z-index:5;text-align:center;padding:18px 12px;background:linear-gradient(180deg,#101826, #1a2230);border-bottom:1px solid var(--border);font-size:26px;font-weight:600;letter-spacing:.5px}
    .wrap{max-width:900px;margin:26px auto;padding:0 16px}

    .card{background:var(--panel);border:1px solid var(--border);border-radius:14px;box-shadow:0 6px 18px rgba(0,0,0,.25)}
    .card-header{display:flex;align-items:center;justify-content:space-between;padding:16px 18px;background:var(--panel-2);border-bottom:1px solid var(--border);border-radius:14px 14px 0 0}
    .card-body{padding:18px}

    label{font-size:14px;color:var(--muted)}
    input[type="date"], textarea{width:100%;padding:12px 12px;background:#0d1117;border:1px solid var(--border);border-radius:10px;color:var(--text);font-size:15px;outline:none}
    textarea{min-height:90px;resize:vertical}

    .topics{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:10px;margin:10px 0 2px}
    .topic{display:flex;gap:8px;align-items:center;padding:10px;border:1px solid var(--border);border-radius:10px;background:#0f1623;cursor:pointer;user-select:none}
    .topic input{accent-color:var(--brand)}

    .actions{display:flex;gap:10px;margin-top:16px}
    .btn{appearance:none;border:1px solid var(--border);background:var(--brand);color:#001018;font-weight:700;padding:12px 16px;border-radius:10px;cursor:pointer;flex:1}
    .btn:hover{background:var(--brand-2)}
    .btn-secondary{background:#0f1623;color:var(--text)}

    .meter{height:10px;width:100%;background:#0f1623;border:1px solid var(--border);border-radius:999px;overflow:hidden}
    .meter > span{display:block;height:100%;width:0;background:var(--brand);transition:width .25s ease}
    .progress-row{display:flex;align-items:center;gap:10px;margin-top:8px}
    .chip{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;border:1px solid var(--border);background:#0f1623;color:var(--muted);font-size:12px}

    .logs{margin-top:22px}
    .log-item{background:var(--panel-2);padding:14px;border-radius:12px;border:1px solid var(--border);margin-bottom:12px}
    .log-head{display:flex;justify-content:space-between;align-items:center;gap:10px}
    .log-topics{margin:8px 0;color:var(--muted);font-size:14px}
    .log-actions{display:flex;gap:8px}
    .tiny{font-size:12px;color:var(--muted)}
    .danger{background:transparent;color:#ffb4b4;border-color:#663838}

    footer{opacity:.8;text-align:center;margin:24px 0;font-size:12px;color:var(--muted)}
  </style>
</head>
<body>
  <header>Flutter Learning Tracker</header>
  <div class="wrap">
    <section class="card" aria-labelledby="track-title">
      <div class="card-header">
        <div id="track-title">Track Your Daily Progress</div>
        <div class="chip" id="live-count">0 / 0 selected</div>
      </div>
      <div class="card-body">
        <div class="field">
          <label for="date">Date</label>
          <input type="date" id="date" />
        </div>

        <div class="field" style="margin-top:10px">
          <label> Select Topics Covered Today </label>
          <div class="topics" id="topics">
            <label class="topic"><input type="checkbox" value="Widgets"> Widgets</label>
            <label class="topic"><input type="checkbox" value="Stateful & Stateless"> Stateful & Stateless</label>
            <label class="topic"><input type="checkbox" value="Layouts"> Layouts</label>
            <label class="topic"><input type="checkbox" value="Navigation"> Navigation</label>
            <label class="topic"><input type="checkbox" value="Forms & Validation"> Forms & Validation</label>
            <label class="topic"><input type="checkbox" value="State Management (Provider/BLoC)"> State Management (Provider/BLoC)</label>
            <label class="topic"><input type="checkbox" value="Networking / REST"> Networking / REST</label>
            <label class="topic"><input type="checkbox" value="Local Storage (SQflite/Hive)"> Local Storage (SQflite/Hive)</label>
            <label class="topic"><input type="checkbox" value="Firebase"> Firebase</label>
            <label class="topic"><input type="checkbox" value="Animations"> Animations</label>
            <label class="topic"><input type="checkbox" value="Testing"> Testing</label>
            <label class="topic"><input type="checkbox" value="Deployment"> Deployment</label>
          </div>
        </div>

        <div class="progress-row">
          <div class="chip" id="live-progress">Progress: 0%</div>
          <div class="meter" aria-label="Progress meter"><span id="meter-fill"></span></div>
        </div>

        <div class="field" style="margin-top:14px">
          <label for="remarks">Remarks</label>
          <textarea id="remarks" placeholder="Your notes..."></textarea>
        </div>

        <div class="actions">
          <button class="btn" id="save-btn">Save Today's Log</button>
          <button class="btn btn-secondary" id="clear-btn" title="Clear selections for today">Clear</button>
        </div>

        <div class="tiny" style="margin-top:10px">Tip: progress auto-calculates from the number of topics ticked.</div>
      </div>
    </section>

    <section class="logs" aria-labelledby="logs-title">
      <h2 class="tiny" id="logs-title">Your Logs</h2>
      <div id="logs"></div>
    </section>
  </div>

  <footer>Made for daily Flutter learning. Data is stored locally in your browser.</footer>

  <script>
    // ---- Pure logic (testable) ----
    function calculateProgress(totalTopics, selectedCount){
      if(!Number.isFinite(totalTopics) || totalTopics <= 0) return 0;
      const pct = Math.round((selectedCount/totalTopics)*100);
      return Math.max(0, Math.min(100, pct));
    }

    // Simple console test cases (do not change unless clearly wrong)
    (function runSelfTests(){
      console.assert(calculateProgress(10, 0) === 0, '0/10 should be 0%');
      console.assert(calculateProgress(10, 10) === 100, '10/10 should be 100%');
      console.assert(calculateProgress(4, 2) === 50, '2/4 should be 50%');
      console.assert(calculateProgress(3, 1) === 33 || calculateProgress(3,1) === 33, '1/3 should round to 33%');
      console.assert(calculateProgress(0, 0) === 0, '0 topics should be 0%');
    })();

    // ---- DOM wiring ----
    const topicsContainer = document.getElementById('topics');
    const dateEl = document.getElementById('date');
    const remarksEl = document.getElementById('remarks');
    const liveCountEl = document.getElementById('live-count');
    const liveProgressEl = document.getElementById('live-progress');
    const meterFillEl = document.getElementById('meter-fill');
    const saveBtn = document.getElementById('save-btn');
    const clearBtn = document.getElementById('clear-btn');
    const logsDiv = document.getElementById('logs');

    function getAllTopicInputs(){
      return Array.from(topicsContainer.querySelectorAll('input[type="checkbox"]'));
    }

    function currentSelection(){
      const inputs = getAllTopicInputs();
      const selected = inputs.filter(i=>i.checked).map(i=>i.value);
      return { inputs, selected };
    }

    function refreshLiveProgress(){
      const { inputs, selected } = currentSelection();
      const total = inputs.length;
      const pct = calculateProgress(total, selected.length);
      liveCountEl.textContent = `${selected.length} / ${total} selected`;
      liveProgressEl.textContent = `Progress: ${pct}%`;
      meterFillEl.style.width = pct + '%';
    }

    function clearToday(){
      getAllTopicInputs().forEach(i=>{ i.checked = false; });
      remarksEl.value = '';
      refreshLiveProgress();
    }

    function todayISO(){
      const d = new Date();
      const pad = n=>String(n).padStart(2,'0');
      return `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())}`;
    }

    function saveLog(){
      const { inputs, selected } = currentSelection();
      const total = inputs.length;
      const progress = calculateProgress(total, selected.length);

      const dateVal = dateEl.value || todayISO();
      if(selected.length === 0){
        alert('Please tick at least one topic.');
        return;
      }

      const log = { date: dateVal, topics: selected, remarks: remarksEl.value.trim(), progress };
      const logs = JSON.parse(localStorage.getItem('flutterLogs')||'[]');
      logs.push(log);
      // keep newest first when rendering
      localStorage.setItem('flutterLogs', JSON.stringify(logs));

      // reset UI
      dateEl.value = '';
      clearToday();
      loadLogs();
    }

    function deleteLog(index){
      const logs = JSON.parse(localStorage.getItem('flutterLogs')||'[]');
      logs.splice(index,1);
      localStorage.setItem('flutterLogs', JSON.stringify(logs));
      loadLogs();
    }

    function loadLogs(){
      const logs = JSON.parse(localStorage.getItem('flutterLogs')||'[]');
      // newest first
      const data = [...logs].reverse();
      logsDiv.innerHTML = '';
      data.forEach((log, idx)=>{
        const pct = calculateProgress(100, log.progress); // log.progress already 0..100; this keeps bar consistent
        const el = document.createElement('div');
        el.className = 'log-item';
        el.innerHTML = `
          <div class="log-head">
            <strong>${log.date}</strong>
            <div class="log-actions">
              <button class="btn tiny danger" data-action="delete">Delete</button>
            </div>
          </div>
          <div class="log-topics"><b>Topics:</b> ${log.topics.join(', ')}</div>
          <div class="tiny"><b>Remarks:</b> ${log.remarks || 'â€”'}</div>
          <div class="tiny" style="margin-top:8px"><b>Progress:</b> ${log.progress}%</div>
          <div class="meter" style="margin-top:6px"><span style="width:${log.progress}%"></span></div>
        `;
        el.querySelector('[data-action="delete"]').addEventListener('click',()=>{
          // convert render index back to original index in storage
          const originalIndex = logs.length - 1 - idx;
          deleteLog(originalIndex);
        });
        logsDiv.appendChild(el);
      });
    }

    // wire events
    topicsContainer.addEventListener('change', refreshLiveProgress);
    saveBtn.addEventListener('click', saveLog);
    clearBtn.addEventListener('click', clearToday);

    // init
    refreshLiveProgress();
    loadLogs();
  </script>
</body>
</html>
